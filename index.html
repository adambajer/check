<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OKbase na zařízení Android</title>
    <style>
        .checkmark {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        #details {
            display: none; /* Skryj informace o zařízení */
        }
    </style>
</head>
<body>
    <h1>OKbase na zařízení Android</h1>
    <ul>
        <li>140MB volného místa <span id="storageCheck"></span></li>
        <li>Android 10 nebo vyšší <span id="androidCheck"></span></li>
        <li>Aplikaci Microsoft Edge <span id="edgeCheck"></span></li>
        <li>Aplikaci Portál společnosti <span id="companyPortalCheck"></span></li>
        <li>Zámek obrazovky <span id="screenLockCheck"></span></li>
    </ul>
    <p id="result"></p>
    <div id="link" style="display: none;">
        <p>Všechny požadavky jsou splněny! Můžete pokračovat na:</p>
        <a href="https://okbase2.miele.com" target="_blank">OKbase</a>
    </div>
    <div id="appLinks" style="display: none;">
        <p>Některé aplikace nejsou nainstalovány. Stáhněte si je z Google Play:</p>
        <ul>
            <li><a href="https://play.google.com/store/apps/details?id=com.microsoft.emmx" target="_blank">Stáhnout Microsoft Edge</a></li>
            <li><a href="https://play.google.com/store/apps/details?id=com.microsoft.windowsintune.companyportal" target="_blank">Stáhnout Portál společnosti</a></li>
        </ul>
    </div>
    <h2 id="detailsHeader" style="display: none;">Informace o zařízení:</h2>
    <ul id="details">
        <li id="os"></li>
        <li id="browser"></li>
        <li id="screen"></li>
        <li id="androidVersion"></li>
    </ul>

    <script>
        async function runCompleteTest() {
            let result = "Všechny požadavky jsou splněny!";
            let allChecksPassed = true;
            let edgeInstalled = true;
            let companyPortalInstalled = true;

            // Android check
            let androidCheck = document.getElementById("androidCheck");
            let userAgent = navigator.userAgent || navigator.vendor || window.opera;

            if (/android/i.test(userAgent)) {
                let match = userAgent.match(/Android\s([0-9\.]*)/);
                let androidVersion = match ? parseFloat(match[1]) : null;

                if (androidVersion && androidVersion >= 10) {
                    androidCheck.innerHTML = "✔️";
                    androidCheck.classList.add("checkmark");
                } else {
                    allChecksPassed = false;
                    result = "Požadavek na Android 10 nebo vyšší není splněn.";
                    androidCheck.innerHTML = "❌";
                    androidCheck.classList.add("error");
                }
                document.getElementById("androidVersion").innerText = androidVersion
                    ? "Verze Androidu: " + androidVersion
                    : "Android detekován, ale verze neznámá.";
            } else {
                allChecksPassed = false;
                result = "Zařízení není Android.";
                androidCheck.innerHTML = "❌";
                androidCheck.classList.add("error");
                document.getElementById("androidVersion").innerText = "";
            }

            // Storage check (orientační, není přesné)
            let storageCheck = document.getElementById("storageCheck");
            if (navigator.storage && navigator.storage.estimate) {
                const storage = await navigator.storage.estimate();
                if (storage.quota && storage.quota >= 140 * 1024 * 1024) {
                    storageCheck.innerHTML = "✔️";
                    storageCheck.classList.add("checkmark");
                } else {
                    allChecksPassed = false;
                    result = "Nedostatek místa (méně než 140 MB).";
                    storageCheck.innerHTML = "❌";
                    storageCheck.classList.add("error");
                }
            } else {
                storageCheck.innerHTML = "❓";
                allChecksPassed = false;
                result = "Nelze ověřit volné místo na disku.";
            }

            // Browser check for Microsoft Edge
            let edgeCheck = document.getElementById("edgeCheck");
            if (/edg/i.test(userAgent)) {
                edgeCheck.innerHTML = "✔️";
                edgeCheck.classList.add("checkmark");
            } else {
                allChecksPassed = false;
                edgeInstalled = false;
                result = "Aplikace Microsoft Edge není detekována.";
                edgeCheck.innerHTML = "❌";
                edgeCheck.classList.add("error");
            }

            // Company Portal App check (nelze spolehlivě detekovat přes web)
            let companyPortalCheck = document.getElementById("companyPortalCheck");
            companyPortalInstalled = false; // Nelze spolehlivě ověřit
            companyPortalCheck.innerHTML = "❌";
            companyPortalCheck.classList.add("error");

            // Screen lock check
            let screenLockCheck = document.getElementById("screenLockCheck");
            if (navigator.credentials && navigator.credentials.preventSilentAccess) {
                screenLockCheck.innerHTML = "✔️";
                screenLockCheck.classList.add("checkmark");
            } else {
                allChecksPassed = false;
                result = "Zámek obrazovky nelze ověřit.";
                screenLockCheck.innerHTML = "❓";
            }

            // Zobraz odkazy na aplikace, pokud nejsou instalovány
            if (!edgeInstalled || !companyPortalInstalled) {
                document.getElementById("appLinks").style.display = "block";
            }

            // Pokud jsou splněny všechny požadavky, zobraz odkaz na OKbase
            if (allChecksPassed) {
                document.getElementById("link").style.display = "block";
            }

            document.getElementById("result").innerText = result;
        }

        runCompleteTest();
    </script>
</body>
</html>
