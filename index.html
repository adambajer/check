<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <!-- Dynamický titulek bude nastaven JavaScriptem -->
  <title>OKbase</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <!-- 1. Google Font (Roboto) -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  
  <!-- 2. Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- 3. Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
.material-symbols-outlined {
  font-variation-settings:
  'FILL' 0,
  'wght' 400,
  'GRAD' 0,
  'opsz' 24
}
</style>  <style>
    .material-symbols-outlined {
      font-variation-settings:
      'FILL' 0,
      'wght' 400,
      'GRAD' 0,
      'opsz' 24
    }
    :root {
      --miele-red: #8C0014;
      --miele-black: #000000;
      --miele-white: #FFFFFF;
      --miele-grey: #6c757d;
      --mark-success: green;
      --mark-failure: red;
      --mark-unknown: orange;
    }
    .mark, mark { 
      background-color: white;
    }
    body {
 
      font-family: 'Roboto', sans-serif;
      background-color: var(--miele-white);
      color: var(--miele-black);
    }
  
    .info-icon {
      color: var(--miele-red);
      font-size: 1.5rem;
      cursor: pointer;
      transition: color 0.3s;
    }
    .info-icon:hover {
      color: var(--miele-red);
    }
    .spinner-container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 60vh;
    }
    h1#headline {
      font-weight: 700;
      margin-bottom: 2rem;
      color: var(--miele-black);
    }
    h2 {
      font-weight: 600;
      margin-top: 2rem;
      margin-bottom: 1rem;
      text-transform: uppercase;
      font-size: 1.3rem;
    }
    .check-row {
      display: grid;
      grid-template-columns: 50px 1fr;
      align-items: center;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .check-row .mark {
      font-weight: bold;
      font-size: 1.2rem;
      text-align: center;
    }
    .check-row .unknown {
      position: relative;
      cursor: help;
    }
    .check-row .unknown .tooltip-text {
      visibility: hidden;
      width: 120px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 4px;
      padding: 6px;
      position: absolute;
      top: 150%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.8rem;
      z-index: 99;
      white-space: nowrap;
    }
    .check-row .unknown:hover .tooltip-text {
      visibility: visible;
    }
    .check-row .ok {
      color: var(--mark-success);
    }
    .check-row .fail {
      color: var(--mark-failure);
    }
    .download-link {
      margin-bottom: 1rem;
      font-size: 1.1rem;
      text-align: left;
    }
    .download-link a {
      color: var(--miele-red);
      text-decoration: none;
      font-weight: bold;
    }
    .download-link a:hover {
      text-decoration: underline;
    }
    .btn-primary {
      background-color: var(--miele-red);
      border: none;
      padding: 0.75rem 1.5rem;
      font-weight: 600;
      font-size: 1rem;
      transition: background-color 0.3s ease;
    }
    .btn-primary:hover {
      background-color: #c80026;
    }
    .modal-header {
      background-color: var(--miele-red);
      color: var(--miele-white);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .modal-title {
      margin: 0;
      font-size: 1.5rem;
    }
    .modal-body pre {
      background-color: #f8f9fa;
      padding: 1rem;
      border-radius: 0.25rem;
      font-size: 0.9rem;
      overflow-x: auto;
    }
    #infoIcon {
      position: fixed;
      top: 1rem;
      right: 1rem;
      z-index: 1050;
    }
    @media (max-width: 600px) {
   
      .info-icon {
        font-size: 1.2rem;
      }
      .check-row .mark {
        font-size: 1rem;
      }
      .download-link {
        font-size: 1rem;
      }
      .modal-title {
        font-size: 1.2rem;
      }
      .check-row {
        grid-template-columns: 40px 1fr;
      }
    }
    h1 {
      text-align:left;
    }
    h2 {
      text-align:left;
    } 
  </style>
</head>
<body>
<div class="container">
    <div class="text-center">
        <a href="/"><img src="logo.png" style="max-width: 160px;"></a>
    </div>
        <br>
</div>
  <!-- 2) Info Icon in Top-Right Corner -->
  <div id="infoIcon">
    <i class="bi bi-info-circle info-icon" data-bs-toggle="modal" data-bs-target="#infoModal" title="Informace"></i>
  </div>
  
  <!-- 3) Spinner -->
  <div class="spinner-container">
    <div class="spinner-border text-danger" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>
  
  <!-- 4) Main Content -->
  <div class="container my-4" id="mainContent" style="display: none;">
    <h1 id="headline" class="mb-4"></h1>
    
    <!-- Kontrola požadavků -->
    <h2 class="">Kontrola požadavků</h2>
    <div id="requirements" class="mb-4">
      <!-- Dynamické Check Rows Bude Zde -->
    </div>
    
    <!-- Ke stažení -->
    <h2 class="">Ke stažení</h2>
    <div id="downloads" class="mb-4">
      <!-- Dynamické Download Links Bude Zde -->
    </div>
    
    <!-- Link to OKbase -->
    <hr>
    <div class="">
      <a href="https://okbase2.miele.com" class="btn btn-primary" target="_blank">Přejít na OKbase</a>
    </div>
  </div>
  
  <!-- 5) Modal for Detailed Information -->
  <div class="modal fade" id="infoModal" tabindex="-1" aria-labelledby="infoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="infoModalLabel">Informace o zařízení</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Zavřít"></button>
        </div>
        <div class="modal-body">
          <div id="modalContent">
            <!-- Strukturované Informace z UAParser.js Budou Zde -->
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- 6) Bootstrap JS Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- 7) UAParser.js -->
  <script src="https://cdn.jsdelivr.net/npm/ua-parser-js"></script>
  
  <script>
    
  const parser = '';
  const result ='';
    document.addEventListener('DOMContentLoaded', () => {
      runDetection();
    });
    
   
    
function runDetection() {
  // Hide Spinner and Show Main Content
  const spinner = document.querySelector('.spinner-container');
  spinner.style.display = 'none';
  const mainContent = document.getElementById('mainContent');
  mainContent.style.display = 'block';
  
  // Initialize UAParser
  const parser = new UAParser();
  const result = parser.getResult();
  
  // Correct Edge Detection for Chromium-based Edge
  if (result.browser.name === 'Chrome' && /Edg\/\d+/.test(navigator.userAgent)) {
    result.browser.name = 'Edge';
    result.browser.version = navigator.userAgent.match(/Edg\/(\d+)/)[1];
  }
  
  // Extract OS and Browser Information
  let osFamily = result.os.name ? result.os.name.toLowerCase() : 'unknown';
  const browserFamily = result.browser.name ? result.browser.name.toLowerCase() : 'unknown';
  
  // Unify macOS and iOS to "iOS"
  if (osFamily.includes('mac os') || osFamily.includes('ios')) {
    osFamily = 'ios';
  }
  
  // Set Dynamic Headline and Document Title
  const headline = document.getElementById('headline');
  if (osFamily.includes('android')) {
    headline.textContent = 'OKbase na zařízení Android';
    document.title = 'OKbase na Android';
    displayAndroidChecks(result);
  } else if (osFamily.includes('ios')) {
    headline.textContent = 'OKbase na zařízení iOS';
    document.title = 'OKbase na iOS';
    displayIOSChecks(result, browserFamily);
  } else if (osFamily.includes('windows')) {
    headline.textContent = 'OKbase na zařízení Windows';
    document.title = 'OKbase na Windows';
    displayWindowsChecks(result, browserFamily);
  } else {
    headline.textContent = 'Neznámé zařízení';
    document.title = 'Neznámé zařízení';
  }
  
  // Populate Modal with Structured Data
  populateModal(result);
}
    /* -----------------------------------------------------------------------
       DISPLAY FUNCTIONS
    ------------------------------------------------------------------------ */
    
    function displayAndroidChecks(result) {
      const requirements = document.getElementById('requirements');
      
      // Minimální verze Android 10
      const androidVersionOK = result.os.version && parseInt(result.os.version, 10) >= 10;
      requirements.appendChild(createCheckRow('Minimální verze Android 10', androidVersionOK));
      
      // Volné místo 140 MB (Simulováno jako vždy OK)
      requirements.appendChild(createCheckRow('Volné místo 140 MB', true));
      
      // Microsoft Edge
      const edgeInstalled = (result.browser.name && result.browser.name.toLowerCase() === 'edge');
      requirements.appendChild(createCheckRow('Microsoft Edge', edgeInstalled));
      
      // Portál společnosti (Vždy Neznámé)
      requirements.appendChild(createCheckRowPortal('Portál společnosti'));
      
      // Populate Downloads
      const downloads = document.getElementById('downloads');
      
      // If Edge is not installed, show download link
      if (!edgeInstalled) {
        downloads.appendChild(createDownloadLink('Microsoft Edge', 'https://play.google.com/store/apps/details?id=com.microsoft.emmx', 'Google Play'));
      }
      
      // Always show Company Portal download link
      downloads.appendChild(createDownloadLink('Portál společnosti', 'https://play.google.com/store/apps/details?id=com.microsoft.portal', 'Google Play'));
    }
 
    function displayIOSChecks(result, browserFamily) {
      const requirements = document.getElementById('requirements');
      
      const iosVersion = result.os.version ? parseInt(result.os.version.split('.')[0], 10) : 0;
      const iosVersionOK = iosVersion >= 16;
      
      requirements.appendChild(createCheckRow('Minimální verze iOS 16', iosVersionOK));
      
      const edgeInstalled = (browserFamily === 'edge');
      requirements.appendChild(createCheckRow('Microsoft Edge', edgeInstalled));
      
      requirements.appendChild(createCheckRowPortal('Portál společnosti'));
      
      const downloads = document.getElementById('downloads');
      
      if (!edgeInstalled) {
        downloads.appendChild(createDownloadLink('Microsoft Edge', 'https://apps.apple.com/app/microsoft-edge/id1288723196', 'App Store'));
      }
      
      downloads.appendChild(createDownloadLink('Portál společnosti', 'https://apps.apple.com/app/microsoft-company-portal/id719171358', 'App Store'));
    }

    
    function displayWindowsChecks(browserFamily) {
      const requirements = document.getElementById('requirements');
      
      // Microsoft Edge
      const edgeInstalled = (browserFamily === 'edge');
      requirements.appendChild(createCheckRow('Microsoft Edge', edgeInstalled));
      
      // Portál společnosti (Vždy Neznámé)
      requirements.appendChild(createCheckRowPortal('Portál společnosti'));
      
      // Populate Downloads
      const downloads = document.getElementById('downloads');
      
      // If Edge is not installed, show download link
      if (!edgeInstalled) {
        downloads.appendChild(createDownloadLink('Microsoft Edge', 'https://www.microsoft.com/edge', 'Oficiální stránka'));
      }
      
      // Always show Company Portal download link
      downloads.appendChild(createDownloadLink('Portál společnosti', 'https://www.microsoft.com/store/productId/9WZDNCRFJ3PT', 'Oficiální stránka'));
    }
    
    /* -----------------------------------------------------------------------
       HELPER FUNCTIONS
    ------------------------------------------------------------------------ */
    
    function createCheckRow(text, isOK) {
      const row = document.createElement('div');
      row.className = 'check-row';
      let markClass = '';
      let markSymbol = '';
      
      if (isOK) {
        markClass = 'ok';
        markSymbol = '<span class="material-symbols-outlined">check</span>';
      } else {
        markClass = 'fail';
        markSymbol = '<span class="material-symbols-outlined">close</span>';
      }
      
      row.innerHTML = `
        <span class="mark ${markClass}">${markSymbol}</span>
        <span>${text}</span>
      `;
      return row;
    }
    
    // V této verzi je otazník s tooltipem, kde se teprve na hover ukáže text "Nelze zjistit"
    function createCheckRowPortal(text) {
      const row = document.createElement('div');
      row.className = 'check-row';
      row.innerHTML = `
        <span class="mark unknown">
        <span class="material-symbols-outlined">question_mark</span>
          <span class="tooltip-text">Nelze zjistit</span>
        </span>
        <span>${text}</span>
      `;
      return row;
    }
    
    function createDownloadLink(appName, url, storeName) {
      const linkDiv = document.createElement('div');
      linkDiv.className = 'download-link';
      linkDiv.innerHTML = `
        <span>Stáhněte ${appName}:</span>
        <a href="${url}" target="_blank">${storeName}</a>
      `;
      return linkDiv;
    }
    
    /* -----------------------------------------------------------------------
       MODAL POPULATION
    ------------------------------------------------------------------------ */
     function populateModal(result) {
      const modalContent = document.getElementById('modalContent');
      modalContent.innerHTML = result; // Clear any existing content
      
   
    }
    
    function formatObject(obj) {
      if (!obj || Object.keys(obj).length === 0) {
        return 'Neznámé';
      }
      return JSON.stringify(obj, null, 2);
    }
  </script>
  
</body>
</html>
