<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OKbase + Detect.js (Local Hosting) Demo</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon"> <!-- Optional: Add a favicon -->
  <style>
    body {
      margin: 1rem;
      font-family: sans-serif;
    }
    h1 { margin-bottom: 1rem; }
    /* Spinner + Animace */
    .spinner {
      width: 50px; height: 50px;
      border: 5px solid #ccc;
      border-top-color: #0078d7;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 2rem auto;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
    #loadingSpinner {
      display: flex;
      align-items: center;
      justify-content: center;
    }
    /* Obsah (skrytý do odhalení) */
    #mainContent {
      display: none;
    }

    .mark { font-weight: bold; }
    .ok   { color: green; }
    .unknown { color: orange; }

    /* Responzivita */
    @media (max-width:600px) {
      body { font-size:0.95rem; }
      h1 { font-size:1.1rem; }
      .spinner {
        width:30px; height:30px;
      }
    }
  </style>
</head>
<body>

<!-- 1) Spinner -->
<div id="loadingSpinner">
  <div class="spinner"></div>
</div>

<!-- 2) Hlavní obsah -->
<div id="mainContent">
  <h1 id="headline"></h1>

  <!-- Pouze Android => 4 řádky -->
  <ul id="androidChecks" style="display:none;">
    <li>Minimální verze Android 10: <span class="mark unknown" id="androidVersion">?</span></li>
    <li>Volné místo 140 MB: <span class="mark unknown" id="androidSpace">?</span></li>
    <li>Microsoft Edge: <span id="edgeAndroid" class="mark unknown">?</span></li>
    <li>Portál společnosti: <span class="mark unknown" id="androidPortal">?</span></li>
  </ul>

  <!-- Windows => 1 řádek pro Edge -->
  <ul id="windowsChecks" style="display:none;">
    <li>Microsoft Edge: <span id="edgeWindows" class="mark unknown">?</span></li>
  </ul>

  <!-- Apple => jen nadpis (poslední) -->
  <ul id="appleChecks" style="display:none;">
    <li>Portál společnosti: <span class="mark unknown" id="applePortal">?</span></li>
  </ul>

  <!-- Odkaz OKbase vždy -->
  <div>
    <a href="https://okbase2.miele.com" target="_blank">Přejít na OKbase</a>
  </div>
</div>

<!-- 3) Detect.js Hosted Locally -->
<script src="js/detect.js"></script>
<script>
  // Verify Detect.js is loaded
  console.log('Detect.js loaded:', typeof Detect !== 'undefined');

  document.addEventListener('DOMContentLoaded', () => {
    // Allow spinner to be visible for a brief moment
    setTimeout(() => {
      runDetection();
    }, 1000);
  });

  function runDetection() {
    const spinner     = document.getElementById('loadingSpinner');
    const mainContent = document.getElementById('mainContent');
    const headline    = document.getElementById('headline');

    // Ensure Detect is available
    if (typeof Detect === 'undefined') {
      console.error('Detect.js is not loaded.');
      spinner.style.display     = 'none';
      mainContent.style.display = 'block';
      headline.textContent = 'X - Detekce selhala';
      return;
    }

    const info = Detect.parse(navigator.userAgent);

    spinner.style.display     = 'none';
    mainContent.style.display = 'block';

    let osFamily = (info.os && info.os.family) ? info.os.family.toLowerCase() : 'unknown';
    let brFamily = (info.browser && info.browser.family) ? info.browser.family.toLowerCase() : 'unknown';

    const androidChecks = document.getElementById('androidChecks');
    const windowsChecks = document.getElementById('windowsChecks');
    const appleChecks   = document.getElementById('appleChecks');

    // Reset UI
    headline.textContent = '';
    androidChecks.style.display = 'none';
    windowsChecks.style.display = 'none';
    appleChecks.style.display = 'none';

    // 1) Android => 4 řádky
    if (osFamily.includes('android')) {
      headline.textContent = 'OKbase na zařízení Android';
      androidChecks.style.display = 'block';

      // Check Android version (assuming info.os.version exists)
      const androidVersionEl = document.getElementById('androidVersion');
      if (info.os.version && parseInt(info.os.version, 10) >= 10) {
        androidVersionEl.textContent = '✔️';
        androidVersionEl.classList.remove('unknown');
        androidVersionEl.classList.add('ok');
      } else {
        androidVersionEl.textContent = '❌';
        androidVersionEl.classList.remove('unknown');
        androidVersionEl.classList.add('unknown');
      }

      // Check free space (placeholder logic)
      const androidSpaceEl = document.getElementById('androidSpace');
      // Implement actual free space check if possible
      androidSpaceEl.textContent = '✔️';
      androidSpaceEl.classList.remove('unknown');
      androidSpaceEl.classList.add('ok');

      // Check for Microsoft Edge
      const edgeAndroidEl = document.getElementById('edgeAndroid');
      if (brFamily.includes('edge')) {
        edgeAndroidEl.textContent = '✔️';
        edgeAndroidEl.classList.remove('unknown');
        edgeAndroidEl.classList.add('ok');
      } else {
        edgeAndroidEl.textContent = '❌';
        edgeAndroidEl.classList.remove('unknown');
        edgeAndroidEl.classList.add('unknown');
      }

      // Portal Check (placeholder logic)
      const androidPortalEl = document.getElementById('androidPortal');
      // Implement actual portal availability check if possible
      androidPortalEl.textContent = '✔️';
      androidPortalEl.classList.remove('unknown');
      androidPortalEl.classList.add('ok');

    // 2) Apple => Display relevant checks
    } else if (osFamily.includes('ios') || osFamily.includes('iphone') || osFamily.includes('ipad')) {
      headline.textContent = 'OKbase na zařízení Apple';
      appleChecks.style.display = 'block';

      // Portal Check (placeholder logic)
      const applePortalEl = document.getElementById('applePortal');
      // Implement actual portal availability check if possible
      applePortalEl.textContent = '✔️';
      applePortalEl.classList.remove('unknown');
      applePortalEl.classList.add('ok');

    // 3) Windows => 1 řádek pro Edge
    } else if (osFamily.includes('windows')) {
      headline.textContent = 'OKbase na zařízení Windows';
      windowsChecks.style.display = 'block';

      const edgeWindowsEl = document.getElementById('edgeWindows');
      if (brFamily.includes('edge')) {
        edgeWindowsEl.textContent = '✔️';
        edgeWindowsEl.classList.remove('unknown');
        edgeWindowsEl.classList.add('ok');
      } else {
        edgeWindowsEl.textContent = '❌';
        edgeWindowsEl.classList.remove('unknown');
        edgeWindowsEl.classList.add('unknown');
      }

    // 4) Neznámé => křížek v nadpisu
    } else {
      headline.textContent = 'X - Neznámé zařízení';
    }
  }
</script>

</body>
</html>
